<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/>
    <title>USAC: E-Rate Applicants and Funding</title>>
    <link rel="stylesheet" href="https://js.arcgis.com/3.24/esri/css/esri.css">
    <style>

	  html, body, #map{
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
      }
	  
      body {
        background-color: #FFF;
        overflow: hidden;
        font-family: "Trebuchet MS";
      }
	  
  
    </style>
    <script src="https://js.arcgis.com/3.24/"></script>
    <script>
      var map, csv;
      require([
        "esri/map", 
        "esri/layers/CSVLayer",
        "esri/Color",
        "esri/symbols/SimpleMarkerSymbol",
        "esri/renderers/SimpleRenderer",
        "esri/InfoTemplate",
        "esri/config",
		"esri/dijit/Popup",
		"esri/dijit/Scalebar",
		"dijit/layout/BorderContainer",
		"dijit/layout/ContentPane",
		"dojo/parser",
        "dojo/domReady!"
      ], function(
        Map, 
		CSVLayer, 
		Color, 
		SimpleMarkerSymbol, 
		SimpleRenderer, 
		InfoTemplate,
		parser,
		esriConfig,
		Scalebar
		) {

		//Set up the map pane with map information//
        
        map = new Map("map", {
          basemap: "gray",
          center: [ -120, 35 ],
          zoom: 3
        })
		
		//Add CSV data to map//
        csv = new CSVLayer("Erate_Basic_Information_filtered_2018_rev.csv", {
          copyright:"E-Rate Information: USAC" 
        });
		
		//Setting up the point symbols using USAC colors//
        var darkBlue = new Color([0, 74, 212, 0.75]); 
        var marker = new SimpleMarkerSymbol("solid", 4, null, darkBlue);
        var renderer = new SimpleRenderer(marker);
        csv.setRenderer(renderer);
        
		//Setting up the pop-up template//
		var infoTemplate = new InfoTemplate();
		infoTemplate.setTitle("App#: ${AppNo}");
		infoTemplate.setContent("<b>${OrgName}</b><br />" +
				"${Address1} ${Address2}<br />"+ 
				"${City}, ${State} ${ZipCode}<br /><br />" + 
				"<b>School Information:</b> <br />"+
				"A ${URStatus} school in<br />"	+
				"${CongDist} with<br />"	+ 
				"${Enrollment} students enrolled<br /><br />" +
				"<b>Requested Funding:</b> ${FundReqAmt}<br />" + 
				"<b>Funding per student:</b> ${FundStud}"
				);
		
		//Adding Pop-up template to map with CSV info//
		csv.setInfoTemplate(infoTemplate);
		
		//Adding CSV to map//
        map.addLayer(csv);
		
		map.on("load", function(){
		
			//Add in Scalebar on map load//
			  new Scalebar({
			  map: map,
			  // "dual" displays both miles and kilometers
			  // "english" is the default, which displays miles
			  // use "metric" for kilometers
			  attachTo:"bottom-left",
			  scalebarUnit: "dual"
			});
			
			
		});
      });
	  
    </script>
  </head>

  <body>

      <div id="map">
      </div>

  </body>
</html>